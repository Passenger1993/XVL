XVL ‚Äî X-Ray Vision Lab

![Python](https://img.shields.io/badge/python-3.9+-blue.svg)
![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-ee4c2c.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)
![Code style](https://img.shields.io/badge/code%20style-black-000000.svg)

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏—Ö —Å–Ω–∏–º–∫–æ–≤ —Å–≤–∞—Ä–Ω—ã—Ö —à–≤–æ–≤ –∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ –±–∞–∑–µ YOLO. –ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω: –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ–∫—Ü–∏–∏
–ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

–ò—Å—Ö–æ–¥–Ω—ã–π —Å–Ω–∏–º–æ–∫	–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ç–µ–∫—Ü–∏–∏
![–ü—Ä–∏–º–µ—Ä 1](./examples/case1.png)	![–ü—Ä–∏–º–µ—Ä 2](./examples/case2.png)
–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ø–∞–ø–∫–∏ examoles –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–µ—Ñ–µ–∫—Ç–æ–≤: —Ç—Ä–µ—â–∏–Ω—ã, –ø–æ—Ä—ã, –Ω–µ–ø—Ä–æ–≤–∞—Ä—ã.

üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
bash
git clone https://github.com/Passenger1993/XVL.git
cd XVL
pip install -e .
2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –º–æ–¥–µ–ª–∏
–í–µ—Å–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ (best.pt) –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ Hugging Face Hub:

bash
python scripts/download_weights.py
–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –≤–µ—Å–∞ –≤ src/models/weights/.

3. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
bash
python src/run.py
–ó–∞–ø—É—Å—Ç–∏—Ç –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å PyQt5 –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

XVL/
‚îú‚îÄ‚îÄ .github

‚îÇ   ‚îî‚îÄ‚îÄ workflows/                  # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

‚îÇ       ‚îî‚îÄ‚îÄ docker-test.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–∞ Docker

‚îÇ

‚îú‚îÄ‚îÄ data/                          # –î–∞–Ω–Ω—ã–µ

‚îÇ   ‚îú‚îÄ‚îÄ processed_dataset/         # –ê—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—ã

‚îÇ   ‚îú‚îÄ‚îÄ raw/                       # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å–Ω–∏–º–∫–∏

‚îÇ   ‚îú‚îÄ‚îÄ results/                   # –ü—Ä–∏–º–µ—Ä—ã –¥–µ—Ç–µ–∫—Ü–∏–∏ (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)

‚îÇ   ‚îî‚îÄ‚îÄ synthetic_dataset/         # –ü—Ä–∏–º–µ—Ä—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ç–æ

‚îÇ   ‚îî‚îÄ‚îÄ training/                  # –û–±—É—á–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

‚îÇ
‚îú‚îÄ‚îÄ docker/                        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker

‚îú‚îÄ‚îÄ examples/                      # –ü—Ä–∏–º–µ—Ä—ã

‚îú‚îÄ‚îÄ logs/                          # –õ–æ–≥–∏

‚îú‚îÄ‚îÄ notebooks/                     # Jupyter-–Ω–æ—É—Ç–±—É–∫–∏ (—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã)

‚îú‚îÄ‚îÄ src/                           # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

‚îÇ   ‚îú‚îÄ‚îÄ generators/                # –ü–∞–ø–∫–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/                  # –ü–∞–ø–∫–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ defects/                  # –ü–∞–ø–∫–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/                  # –ü–∞–ø–∫–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

‚îÇ   ‚îú‚îÄ‚îÄ gui/                       # –ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (PyQt5)

‚îÇ   ‚îú‚îÄ‚îÄ model/                    # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π –∏ –≤–µ—Å–∞

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configs/                 # –õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (predictor.py)

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inference/                 # –õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (predictor.py)

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ architectures/         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (yolo_custom.py)

‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weights/               # –ü–∞–ø–∫–∞ –¥–ª—è –≤–µ—Å–æ–≤ (.gitignore)

‚îÇ   ‚îú‚îÄ‚îÄ trainer/                  # –°–∫—Ä–∏–ø—Ç—ã –æ–±—É—á–µ–Ω–∏—è

‚îÇ   ‚îú‚îÄ‚îÄ data_generation/           # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ defects/               # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã –¥–µ—Ñ–µ–∫—Ç–æ–≤ (5 –∫–ª–∞—Å—Å–æ–≤)

‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/                  # –ú–µ–Ω–µ–¥–∂–µ—Ä –∏ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã

‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã

‚îÇ   ‚îî‚îÄ‚îÄ utils/                     # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

‚îÇ

‚îú‚îÄ‚îÄ tests/                         # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (pytest)

‚îÇ   ‚îú‚îÄ‚îÄ data_generation/           # –¢–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–≤

‚îÇ   ‚îú‚îÄ‚îÄ inference/                 # –¢–µ—Å—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

‚îÇ   ‚îî‚îÄ‚îÄ test_predictor.py          # –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã

‚îÇ

‚îú‚îÄ‚îÄ .dockerignore                 # –§–∞–π–ª—ã –≤–Ω–µ –¥–æ–∫–µ—Ä-–æ–±—Ä–∞–∑–∞

‚îú‚îÄ‚îÄ .gitignore                    # –§–∞–π–ª—ã –≤–Ω–µ –≥–∏—Ç—Ö–∞–±

‚îú‚îÄ‚îÄ .pre-commit-config.yaml       # –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

‚îú‚îÄ‚îÄ .LICENSE                      # –õ–∏—Ü–µ–Ω–∑–∏—è

‚îú‚îÄ‚îÄ pyproject.toml                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

‚îú‚îÄ‚îÄ README.md                     # –¢–µ–∫—É—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç

‚îú‚îÄ‚îÄ requirements.txt              # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

‚îú‚îÄ‚îÄ requrements-dev.txt           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

‚îî‚îÄ‚îÄ run.py                        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞


üê≥ –ó–∞–ø—É—Å–∫ –≤ Docker (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π GPU)

üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç –ø–æ–∫—Ä—ã—Ç —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -e ".[dev]"

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest --cov=src tests/ --cov-report=html

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–æ–¥—É–ª—è
pytest tests/data_generation/ -v
pytest tests/test_predictor.py -v

# –ó–∞–ø—É—Å–∫ –≤ Docker
docker build -t xvl-tests -f docker/Dockerfile.test .
docker run --rm xvl-tests
–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤ (5 –∫–ª–∞—Å—Å–æ–≤)

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

–õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (predictor)

–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ –¥–µ—Ñ–µ–∫—Ç–∞
–°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤ src/data_generation/defects/

–£–Ω–∞—Å–ª–µ–¥—É–π—Ç–µ –æ—Ç BaseDefectGenerator (–∏–∑ src/data_generation/core/)

–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –≤ DefectManager

–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –≤ tests/data_generation/

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
–û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å ‚Äî YOLOv8 —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏:

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: configs/model_config.yaml

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: src/models/architectures/yolo_custom.py

–í–µ—Å–∞: —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ Hugging Face Hub, –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Google Colab (—Å–º. notebooks/training.ipynb)
# –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:
python src/training/train.py --config configs/training_config.yaml
üì¶ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ú–æ–¥–µ–ª—å (configs/model_config.yaml)
yaml
model:
  architecture: "yolov8n"
  num_classes: 5
  pretrained: true
  input_size: [512, 512]

training:
  epochs: 100
  batch_size: 16
  learning_rate: 0.001
  device: "cuda"

üîó –°—Å—ã–ª–∫–∏
–ú–æ–¥–µ–ª—å –Ω–∞ Hugging Face Hub: huggingface.co/Alex-Watchman/XVL/xvl-model

–î–∞—Ç–∞—Å–µ—Ç –Ω–∞ Kaggle: kaggle.com/datasets/your-username/welding-defects

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –¥–µ–º–æ: huggingface.co/spaces/Alex-Watchman/xvl-demo

üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. LICENSE.

XVL ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –≤ –æ–±–ª–∞—Å—Ç–∏ –Ω–µ—Ä–∞–∑—Ä—É—à–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è. –°–∏—Å—Ç–µ–º–∞ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä—É—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å–≤–∞—Ä–Ω—ã—Ö —à–≤–æ–≤.

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è
–ú–æ–¥–µ–ª—å YOLOv8 –ø–æ–∫–∞–∑–∞–ª–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
–ú–µ—Ç—Ä–∏–∫–∞	–ó–Ω–∞—á–µ–Ω–∏–µ	–≠–ø–æ—Ö–∞
Precision	95.6%	37
Recall	88.9%	39
mAP@50	93.3%	39
mAP@50-95	78.8%	37
–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã:
–ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (95.6%)

–•–æ—Ä–æ—à–∞—è –ø–æ–ª–Ω–æ—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–æ–≤ (88.9%)

–û–±—É—á–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å –∫ 30-–π —ç–ø–æ—Ö–µ

–ù–∞–∏–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ—Ç—Ä–∏–∫ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –Ω–∞ 37-–π —ç–ø–æ—Ö–µ
